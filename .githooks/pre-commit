#!/usr/bin/env bash
# Cross-platform wrapper: try PowerShell Core, fall back to python invocation.
HOOK_DIR="$(cd "
$(dirname "$0"); pwd)"
# Try pwsh (PowerShell Core)
if command -v pwsh >/dev/null 2>&1; then
  pwsh -NoProfile -File "$HOOK_DIR/pre-commit.ps1"
  exit $?
fi

# Try Windows PowerShell via powershell.exe (Git for Windows)
if command -v powershell.exe >/dev/null 2>&1; then
  powershell.exe -NoProfile -File "$HOOK_DIR\pre-commit.ps1"
  exit $?
fi

# Fallback: run the analyzer directly with python (non-PowerShell path)
PYTHON="${PYTHON:-python}"
"$PYTHON" "$HOOK_DIR/../scripts/analyze_and_prompt.py"
exit $?